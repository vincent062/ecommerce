{% extends 'base.html.twig' %}

{% block title %}Confirmation - Sunset Shop{% endblock %}

{% block body %}
<div class="min-h-screen py-12 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-orange-200/60 via-rose-50 to-orange-300/50 flex items-center justify-center">
    <div class="container mx-auto px-4 max-w-3xl">
        
        {# Message de succès #}
        <div class="text-center mb-10">
            <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600 mb-6 shadow-lg shadow-green-500/20 animate-bounce">
                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h1 class="text-4xl font-black text-stone-800 mb-2 drop-shadow-sm">Commande Validée !</h1>
            <p class="text-stone-600 text-lg">Merci pour votre achat chez Sunset Shop ☀️</p>
            <p class="text-sm text-stone-400 mt-2 font-mono">Réf: #{{ order.reference }}</p>
        </div>

        {# Carte Récapitulative #}
        <div class="bg-white rounded-[2.5rem] overflow-hidden shadow-[0_20px_60px_-15px_rgba(249,115,22,0.3)] border border-orange-100/50 relative z-10">
            
            {# En-tête de la carte #}
            <div class="bg-gradient-to-r from-orange-50 to-rose-50 p-8 border-b border-orange-100/50">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="text-center md:text-left">
                        <p class="text-xs font-bold text-orange-600 uppercase tracking-wider mb-1">Adresse de livraison</p>
                        <h3 class="font-bold text-stone-800 text-lg">{{ order.deliveryName }}</h3>
                        <p class="text-stone-600">{{ order.deliveryAddress }}</p>
                        <p class="text-stone-600">{{ order.deliveryZipcode }} {{ order.deliveryCity }} - {{ order.deliveryCountry }}</p>
                    </div>
                    <div class="text-center md:text-right">
                         <p class="text-xs font-bold text-orange-600 uppercase tracking-wider mb-1">Date de commande</p>
                         <p class="font-bold text-stone-800">{{ order.createdAt|date('d/m/Y') }}</p>
                    </div>
                </div>
            </div>
{# Liste des produits #}
            <div class="p-8">
                <h3 class="text-lg font-bold text-stone-800 mb-6">Détails de la commande</h3>
                
                <div class="space-y-4 mb-8">
                    {% set finalTotal = 0 %}
                    
                    {# BOUCLE SUR LES PRODUITS #}
                    {% for detail in order.orderDetails %}
                        <div class="flex justify-between items-center border-b border-stone-100 pb-2">
                            <div>
                                <h4 class="font-bold text-stone-700">{{ detail.product }}</h4>
                                <p class="text-xs text-stone-500">Quantité : {{ detail.quantity }} x {{ (detail.price / 100) }} €</p>
                            </div>
                            <div class="font-bold text-stone-800">
                                {{ (detail.total / 100) }} €
                            </div>
                        </div>
                        
                        {# On ajoute au total global #}
                        {% set finalTotal = finalTotal + detail.total %}
                    {% else %}
                        <p class="text-stone-500 italic">Aucun détail disponible.</p>
                    {% endfor %}
                </div>

                <div class="border-t-2 border-dashed border-orange-100 pt-6">
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-stone-600">Total payé</span>
                        <span class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-orange-600 to-rose-600">
                           {{ (finalTotal / 100) }} €
                        </span>
                    </div>
                </div>

                <div class="mt-8 text-center">
                    <a href="{{ path('app_home') }}" class="inline-block py-4 px-10 bg-stone-900 text-white font-bold rounded-2xl hover:bg-orange-600 hover:shadow-lg hover:shadow-orange-500/30 transition transform hover:-translate-y-1">
                        Retourner à la boutique
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}