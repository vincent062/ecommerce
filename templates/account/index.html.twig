{% extends 'base.html.twig' %}

{% block title %}Mon Compte - Sunset Shop{% endblock %}

{% block body %}
<div class="bg-stone-50 min-h-screen py-16">
    <div class="container mx-auto px-4">
        
        <h1 class="text-4xl font-black text-stone-900 mb-10 text-center">
            Mon Espace <span class="text-orange-500">.</span>
        </h1>

        <div class="flex flex-col lg:flex-row gap-10">
            
            {# 1. COLONNE DE GAUCHE : INFO PROFIL #}
            <div class="lg:w-1/3">
                <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-stone-100 sticky top-24">
                    <div class="bg-stone-900 p-8 text-center relative overflow-hidden">
                        {# Glow Effect #}
                        <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-orange-500 to-rose-600 rounded-full blur-3xl opacity-20 transform translate-x-10 -translate-y-10"></div>
                        
                        {# Avatar / Initiale #}
                        <div class="w-24 h-24 mx-auto bg-gradient-to-br from-orange-500 to-rose-600 rounded-full flex items-center justify-center text-white text-3xl font-serif font-bold shadow-lg mb-4 border-4 border-stone-800">
                            {{ app.user.firstname|first|upper }}
                        </div>
                        
                        <h2 class="text-xl font-bold text-white mb-1">
                            {{ app.user.firstname }} {{ app.user.lastname }}
                        </h2>
                        <p class="text-stone-400 text-sm">{{ app.user.email }}</p>
                    </div>

                    <div class="p-6">
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-stone-50 rounded-xl border border-stone-100">
                                <span class="text-stone-500 text-sm">Commandes</span>
                                <span class="font-bold text-stone-900">{{ orders|length }}</span>
                            </div>
                            
                            <a href="{{ path('app_logout') }}" class="block w-full py-3 text-center text-rose-600 font-bold bg-rose-50 hover:bg-rose-100 rounded-xl transition duration-300">
                                Me déconnecter
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            {# 2. COLONNE DE DROITE : HISTORIQUE COMMANDES #}
            <div class="lg:w-2/3">
                <h3 class="text-2xl font-bold text-stone-800 mb-6">Mes dernières commandes</h3>

                {% if orders is empty %}
                    {# CAS : AUCUNE COMMANDE #}
                    <div class="bg-white rounded-3xl shadow-lg p-10 text-center border border-stone-100">
                         <div class="w-20 h-20 bg-stone-100 rounded-full flex items-center justify-center mx-auto mb-6 text-stone-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                            </svg>
                        </div>
                        <p class="text-lg font-bold text-stone-900 mb-2">Vous n'avez pas encore commandé</p>
                        <p class="text-stone-500 mb-6">Explorez notre collection pour trouver votre bonheur.</p>
                        <a href="{{ path('app_home') }}" class="inline-block px-6 py-3 bg-stone-900 text-white rounded-xl font-bold hover:bg-orange-600 transition">
                            Commencer le shopping
                        </a>
                    </div>
                {% else %}
                    {# CAS : LISTE DES COMMANDES #}
                    <div class="space-y-6">
                        {% for order in orders %}
                            <div class="bg-white rounded-2xl shadow-md border border-stone-100 overflow-hidden hover:shadow-lg transition duration-300">
                                <div class="p-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                                    
                                    {# Infos Commande #}
                                    <div>
                                        <div class="flex items-center gap-3 mb-1">
                                            <span class="font-bold text-stone-900 text-lg">#{{ order.reference }}</span>
                                            {% if order.isPaid %}
                                                <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold">Payée</span>
                                            {% else %}
                                                <span class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-xs font-bold">En attente</span>
                                            {% endif %}
                                        </div>
                                        <p class="text-stone-500 text-sm">
                                            Passée le {{ order.createdAt|date('d/m/Y') }}
                                        </p>
                                    </div>

                                    {# Prix et Actions #}
                                    <div class="text-right">
                                        <div class="font-black text-2xl text-stone-900 mb-1">
                                            {{ order.total / 100 }} €
                                        </div>
                                        <div class="text-xs text-stone-400">
                                            {{ order.orderDetails|length }} article(s)
                                        </div>
                                    </div>

                                </div>
                                
                                {# Footer de la carte (Détails) #}
                                <div class="bg-stone-50 px-6 py-3 border-t border-stone-100 flex justify-between items-center">
                                    <span class="text-xs text-stone-400 font-mono">ID: {{ order.id }}</span>
                                    {# Tu pourras ajouter un lien vers le détail plus tard #}
                                    <button class="text-sm font-bold text-stone-600 hover:text-orange-600 transition">
                                        Voir le détail &rarr;
                                    </button>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

            </div>
        </div>
    </div>
</div>
{% endblock %}